"use strict";function init(){function e(e,i){var t=e.args,a=t.tempFilePath,r=o.getFileStat(a);if(a&&r){var s=l.getCurrentProjectConfig(),f=o.getSavedFileList();if(1024*s.Setting.MaxFileStorageSize*1024<f.totalSize+r.size)i({errMsg:"saveFile:fail the maximum size of the file storage limit is exceeded"});else{var n=o.saveFileForever(a);i(n===!1?{errMsg:"saveFile:fail"}:{errMsg:"saveFile:ok",savedFilePath:n})}}else i({errMsg:"saveFile:fail"})}function i(e,i){var t=e.args,a=t.filePath,r=n.extname(a);if(!v[r].toLowerCase())return void i({errMsg:"openDocument:fail filetype not supported"});var s=o.getRealPath(a);return f.existsSync(s)?(nw.Shell.openItem(s),void i({errMsg:"openDocument:ok"})):void i({errMsg:"openDocument:fail fail file not exist"})}function t(e,i){var t=o.getSavedFileList();i({errMsg:"getSavedFileList:ok",fileList:t.fileList})}function a(e,i){var t=e.args;if(t.filePath){var a=o.getFileStat(t.filePath);i(a?{errMsg:"getSavedFileInfo:ok",size:a.size,createTime:parseInt(a.ctime.getTime()/1e3)}:{errMsg:"getSavedFileInfo:fail file doesn't exist"})}else i({errMsg:"getSavedFileInfo:fail"})}function r(e,i){var t=e.args;i(t.filePath?o.removeSavedFile(t.filePath)?{errMsg:"removeSavedFile:ok"}:{errMsg:"removeSavedFile:fail file doesn't exist"}:{errMsg:"removeSavedFile:fail"})}function s(e,i){var t=e.args;if(t.base64Data){var a=o.saveBase64DataToFile(t.base64Data,".jpg");i(a?{errMsg:"base64ToTempFilePath:ok",tempFilePath:a}:{errMsg:"base64ToTempFilePath:fail"})}else i({errMsg:"base64ToTempFilePath:fail"})}var l=(require("../../actions/webviewActions.js"),require("../../stores/projectStores.js")),o=require("../../utils/file.js"),f=require("fs"),n=require("path"),v={".doc":!0,".xls":!0,".ppt":!0,".pdf":!0,".docx":!0,".xlsx":!0,".pptx":!0};_exports={saveFile:e,openDocument:i,getSavedFileList:t,getSavedFileInfo:a,removeSavedFile:r,base64ToTempFilePath:s}}var _exports;init(),module.exports=_exports;