"use strict";function init(){function r(r,e){if(r.error)if("object"===_typeof(r.error)){var o=r.error;e(o.httpCode,{},o.msg),o.type!==j&&o.type!==R||l.showWeappError(o.type,o.type===j?f.parseWxssErr(o):o)}else e(404,{"Weapp-Error":encodeURIComponent(r.error)},r.error.toString());else e(null,{},r.data)}function e(e,m){var j=n.getProject(e),R=n.getFileNameFromUrl(e,j);R=decodeURI(R);var d=n.isWxmlFile(R),x=n.isWxssFile(R);if(x)u(e,{project:j},function(e,o){r({error:e,data:o},m)});else if(d){var S=[];S.push(function(r){var e=p.getAppJSONSync(j),t=e.pages,n=R.replace(o.extname(R),""),s=t.findIndex(function(r){return r===n});s>-1?r(null,s):r({type:y,msgForConsole:y+"app.json 中未配置，当前页面 "+n+" 请检查后重试。",msg:"app.json 中未配置当前页面 <br> "+n+" <br>请检查后重试。"})}),S.push(function(r){s(j,{url:e},function(e,o){r(e,o)})}),S.push(function(r){i(e,{project:j},function(e,o){r(e,o)})}),t.parallel(S,function(r,o){if(r){var t=q.replace(/{{error}}/,function(){return r.msg}).replace(/{{msgForConsole}}/,function(){var e=r.type,o=void 0;return e===g?o=f.parseWxmlErr(j,r.msgForConsole):e===y?o=r.msgForConsole:e===E&&(o=f.parseWxmlLoseErr(j,r.msgForConsole)),o});return void m(500,{},t)}var n={};try{n=p.getPageJSONSync(j,e)}catch(s){l.showWeappError(s.type,f.parseJsonParseErr(s))}var i={config:n,project:j,url:e,pageFrameTpl:o[1],generateFunc:o[2].generateFunc},u=a(i);m(null,u.header,u.body)})}else{var F=c.parse(e),W=F.pathname,v=(o.basename(W),o.extname(R));n.whiteFileExtName[v]?p.getFile(j,R,function(e,o){r({error:e,data:o},m)}):r({error:"404"},m)}}var o=(require("fs"),require("path")),t=require("async"),n=require("../utils/tools.js"),s=(require("../../stores/projectStores.js"),require("./transConfigToPf.js")),i=require("./transWxmlToJs.js"),a=require("./transWxmlToHtml.js"),p=require("../utils/projectManager.js"),u=require("./transWxssToCss.js"),l=require("../../actions/windowActions.js"),c=require("url"),f=require("../utils/parseErr.js"),m=require("../../config/config.js"),g=m.WXML_ERROR,y=m.PAGE_DEFINE_ERROR,j=m.WXSS_ERROR,R=m.WXSS_IMPORT_ERROR,E=m.WXML_LOSE_ERROR,d=require("../../config/config.js"),q=(d.weappLocalIdRegular,require("../tpl/errorTpl.js"));_exports={getResponse:e}}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},_exports;init(),module.exports=_exports;