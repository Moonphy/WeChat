"use strict";function init(){function e(e,n){return"\n      <script>"+d[e.hash]+'</script>\n      <script>\n        document.dispatchEvent(new CustomEvent("generateFuncReady", {\n          detail: {\n            generateFunc: $gwx(\'./'+n+"')\n          }\n        }))\n      </script>\n    "}var n=global.appConfig.isDev,t="darwin"===process.platform,r=(require("fs"),require("path")),o=require("../../config/dirConfig.js"),i=o.WeappVendor,s=require("../utils/tools.js"),c=require("../utils/projectManager.js"),a=n?r.join(__dirname,"../vendor/"):i,u=t?r.join(a,"wcc"):r.join(a,"wcc.exe"),l=(require("glob"),require("child_process").spawn),p=require("../../config/config.js"),g=p.WXML_ERROR,f=p.WXML_LOSE_ERROR,d={};c.manager.on("FILE_CHANGE",function(e,n,t){".wxml"===r.extname(t)&&delete d[e.hash]}),_exports=function(n,t,o){var i=t.project,a=s.getFilePath(n,i),p=r.relative(i.projectpath,a),h="",m="";return d[i.hash]?void process.nextTick(function(){o(null,{generateFunc:e(i,p.replace(/\\/g,"/")),styleStr:h})}):void c.getAllWXMLFileList(i,function(n,t){for(var r=c.getAppJSONSync(i),s=r.pages,a=0,v=s.length;a<v;a++){var x="./"+s[a]+".wxml",w=t.indexOf(x);if(w===-1)return void o({type:f,msgForConsole:a+":"+JSON.stringify(r),msg:"编译 .wxml 文件错误， 错误信息：未找到页面 "+s[a]+" 对应的 wxml 文件"})}n?o(n.toString()):!function(){var n=["-d"].concat(t),r=l(u,n,{cwd:i.projectpath}),s=[],c=[];r.on("close",function(n){if(0===n)d[i.hash]=Buffer.concat(s).toString(),m=e(i,p.replace(/\\/g,"/")),o(null,{generateFunc:m,styleStr:h});else{var t=Buffer.concat(c).toString();o({type:g,msgForConsole:t,msg:"编译 .wxml 文件错误， 错误信息："+t+"，可在控制台查看更详细信息"})}}),r.stdout.on("data",function(e){s.push(e)}),r.stderr.on("data",function(e){c.push(e)})}()})}}var _exports;init(),module.exports=_exports;